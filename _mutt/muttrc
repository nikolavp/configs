# Set a cool color scheme
source ~/.mutt/colors.muttrc
set realname = "Nikola Petrov"
# Using maildir
set mbox_type=Maildir
# Root folder for the mailboxes
set folder=~/Maildir
# Move read messages from spool to mbox
set move=yes

set sort=reverse-threads #Sort messages by threads
set sort_aux=reverse-last-date-received  # then by date

#View text/html automatically
auto_view text/html

# proper next mailbox and message unread
bind index,pager n next-new-then-unread
bind index,pager <TAB> next-unread-mailbox
# some macros for showing the links in the pager
macro pager \cb <pipe-entry>'urlview'<enter> 'Follow links with urlview'
macro pager \cw <pipe-entry>'w3m'<enter> 'Follow links in w3m' 

#sidebar settings
set sidebar_width       = 25
set sidebar_visible     = yes
color sidebar_new yellow default

#Add an email client to abook
macro index,pager A "<pipe-message>abook --add-email<return>" "add the sender address to abook"
#Use abook for query
set query_command = "abook --mutt-query '%s'"

set edit_headers              # The defaults are ok
set pager_stop                # prevent pager from going to next message unlesss you say so
set pager_index_lines=10      # make the pager 10 lines max - adds "preview" support for mutt
set pager_context=5           # number of context lines to show
set nomarkers                 # no wrap around markers
set timeout = 3               # idle time before scanning folders for new mail
set beep_new                  # bell on new mails

# check if this fixes the idiots out there that don't quote messages with > only
#set quote_regexp = "^( {0,4}[>|:#%]| {0,4}[a-z0-9]+[>|]+)+"

set sig_dashes #Add dashed signature if any
set fast_reply #Don't ask me stupid questions on reply
set include                              # include message in replies

set reply_to # reply to Reply-to: field, not From:
set reverse_name # reply as who it was sent to (see alternates)

ignore * # ignore all headers
unignore from: to: cc: date: subject: # show only these
hdr_order from: to: cc: date: subject: # and in this order

#Sidebar bindings
bind index,pager J sidebar-next
bind index,pager K sidebar-prev
bind index,pager O sidebar-open

set folder_format="%2C %t %N %8s %d %f"  # what I settled on


set quit=ask-no               # ask me to quit. default no

alternates "nikolavp@gmail.com|nikola.petrov@sirma.bg|nikola.petrov@ontotext.com"


# Notmuch support
macro index <F8> \
     "<enter-command>unset wait_key<enter><shell-escape>notmuch-mutt -r --prompt search<enter><change-folder-readonly>~/.cache/notmuch/mutt/results<enter>" \
     "notmuch: search mail"
macro index <F9> \
     "<enter-command>unset wait_key<enter><pipe-message>notmuch-mutt -r thread<enter><change-folder-readonly>~/.cache/notmuch/mutt/results<enter><enter-command>set wait_key<enter>" \
     "notmuch: reconstruct thread"
macro index <F6> \
     "<enter-command>unset wait_key<enter><pipe-message>notmuch-mutt tag -- -inbox<enter>" \
      "notmuch: remove message from inbox"

# Handle stupid alternative order emails ;(. I had some problems with the encoding from some people without these
alternative_order text/enriched text/plain text 

# Hooks to enable settings based on the folder I am looking at
folder-hook Ontotext source ~/.mutt/ontotext.muttrc
folder-hook Sirma   source ~/.mutt/sirma.muttrc
folder-hook GMail   source ~/.mutt/gmail.muttrc

# Turn off the help line at the top
set help=no
# Don't ask but just delete/purge messages that were marked 
set delete=yes
# Turn off the exit without saving key (x, by deault), make it exit with
# save (equivalent to by default, q).
bind index x quit

# Source the mailboxes, generated by offlineimap
source ~/.mutt/mailboxes
# Ontotext is the default account I will be using
source ~/.mutt/ontotext.muttrc
